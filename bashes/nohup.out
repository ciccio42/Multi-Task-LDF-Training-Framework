wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_152736-snowi4y2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run desert-wind-41
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/snowi4y2
219462
Appending saved step 219462
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/model_save-219462.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16//results_nut_assembly/run_1
loading model from saved training step 219462
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16//results_nut_assembly/run_1/step-219462
Multi-task dataset, tasks used:  [{'name': 'nut_assembly', 'n_tasks': 9, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8], 'skip_ids': [8], 'loss_mul': 1, 'task_per_batch': 9, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 45500923

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 10 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
Model GPU id 0
Seed: 2746317213
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #0, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 3184935163
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #3, task#8, reached? True picked? False success? False 
Model GPU id 0
Seed: 478163327
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #1, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1181241943
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #4, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1051802512
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #5, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 599310825
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #7, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 958682846
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #6, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 440213415
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #9, task#8, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.9
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.0
Success rate on task#8 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▂▃▃▄▅▆▆▇█
wandb:            picked ███▁██████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:           reached ▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.9
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.0
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 9
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 0.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 8
wandb: 
wandb: 🚀 View run desert-wind-41 at: https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/snowi4y2
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjE0MDI3OA==/version_details/v3
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_152736-snowi4y2/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_153125-c6v3ajst
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run summer-glade-42
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/c6v3ajst
219462
Appending saved step 219462
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/model_save-219462.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/results_nut_assembly/
loading model from saved training step 219462
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/results_nut_assembly/step-219462
Multi-task dataset, tasks used:  [{'name': 'nut_assembly', 'n_tasks': 9, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8], 'skip_ids': [8], 'loss_mul': 1, 'task_per_batch': 9, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 45500923

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 10 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
Model GPU id 0
Seed: 2746317213
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #0, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 107420369
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #2, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 478163327
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #1, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1181241943
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #4, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 3184935163
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #3, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 599310825
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #7, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 958682846
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #6, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 440213415
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #9, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1051802512
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #5, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 3163119785
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #8, task#8, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.1
Success rate on task#8 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▂▃▃▄▅▆▆▇█
wandb:            picked ▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁▁▁▁▁▁█▁
wandb:           reached ▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.1
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 9
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 0.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 8
wandb: 
wandb: 🚀 View run summer-glade-42 at: https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/c6v3ajst
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjE0MDI3OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_153125-c6v3ajst/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_153457-4vg72x0o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-bird-43
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/4vg72x0o
219462
Appending saved step 219462
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/model_save-219462.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/results_nut_assembly/
loading model from saved training step 219462
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left-Batch16/results_nut_assembly/step-219462
Multi-task dataset, tasks used:  [{'name': 'nut_assembly', 'n_tasks': 9, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8], 'skip_ids': [8], 'loss_mul': 1, 'task_per_batch': 9, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 45500923

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 10 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 3.
Model GPU id 0
Seed: 958682846
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #6, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 107420369
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #2, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1181241943
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #4, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 478163327
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #1, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 3184935163
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #3, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 599310825
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #7, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 1051802512
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #5, task#8, reached? True picked? True success? False 
Model GPU id 0
Seed: 3163119785
Panda_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
UR5e_NutAssemblyDistractor
Max-t 95
Evaluated traj #8, task#8, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.0
Success rate on task#8 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▂▃▃▄▅▆▆▇█
wandb:            picked ▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:           reached ▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.0
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 9
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 0.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 8
wandb: 
wandb: 🚀 View run hearty-bird-43 at: https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/runs/4vg72x0o
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Nut-Assembly-Mosaic-100-180-Target-Obj-Detector-GT-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjE0MDI3OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_153457-4vg72x0o/logs
pybullet build time: Sep  9 2023 15:14:45
./test_mosaic_cond_target_obj.sh: 51: Syntax error: "fi" unexpected
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_154700-d0dia6hb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run vivid-moon-61
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/d0dia6hb
137170
Appending saved step 137170
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-137170.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 137170
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-137170
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0004107952117919922
Gen_anc_base 1.4813427925109863
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Error
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Error
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 51, in starmapstar
    return list(itertools.starmap(args[0], args[1]))
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 236, in _proc
    return_rollout = rollout_imitation(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 169, in rollout_imitation
    traj, info = eval_fn(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 533, in pick_place_eval
    return pick_place_eval_demo_cond(model=model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 324, in pick_place_eval_demo_cond
    action, target_pred, target_obj_emb, activation_map, prediction_internal_obj, predicted_bb = get_action(
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/utils.py", line 416, in get_action
    out = model(states=s_t,
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 677, in forward
    embed_out = self._embed(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 234, in forward
    im_features, no_pe_img_features = network_fn(im_in)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 295, in _resnet_features
    features = self._img_encoder(x)  # x is B, T, ch, h, w -> B, T, d, H, W
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/basic_embedding.py", line 48, in forward
    out = self._features(x)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 550, in <module>
    task_success_flags = p.starmap(f, seeds)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 372, in starmap
    return self._map_async(func, iterable, starmapstar, chunksize).get()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 771, in get
    raise self._value
RuntimeError: Input type (torch.cuda.FloatTensor) and weight type (torch.FloatTensor) should be the same
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 🚀 View run vivid-moon-61 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/d0dia6hb
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_154700-d0dia6hb/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_155257-80dhnr4i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run skilled-terrain-62
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/80dhnr4i
140360
Appending saved step 140360
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-140360.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 140360
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-140360
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001461505889892578
Gen_anc_base 0.7053775787353516
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 51, in starmapstar
    return list(itertools.starmap(args[0], args[1]))
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 236, in _proc
    return_rollout = rollout_imitation(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 169, in rollout_imitation
    traj, info = eval_fn(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 533, in pick_place_eval
    return pick_place_eval_demo_cond(model=model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 324, in pick_place_eval_demo_cond
    action, target_pred, target_obj_emb, activation_map, prediction_internal_obj, predicted_bb = get_action(
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/utils.py", line 416, in get_action
    out = model(states=s_t,
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 677, in forward
    embed_out = self._embed(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 234, in forward
    im_features, no_pe_img_features = network_fn(im_in)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 295, in _resnet_features
    features = self._img_encoder(x)  # x is B, T, ch, h, w -> B, T, d, H, W
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/basic_embedding.py", line 48, in forward
    out = self._features(x)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 550, in <module>
    task_success_flags = p.starmap(f, seeds)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 372, in starmap
    return self._map_async(func, iterable, starmapstar, chunksize).get()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 771, in get
    raise self._value
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.023 MB uploaded (0.000 MB deduped)wandb: / 0.023 MB of 0.023 MB uploaded (0.000 MB deduped)wandb: 🚀 View run skilled-terrain-62 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/80dhnr4i
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_155257-80dhnr4i/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_155823-6lbdoia3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-elevator-63
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/6lbdoia3
143550
Appending saved step 143550
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-143550.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 143550
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-143550
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014972686767578125
Gen_anc_base 0.6907668113708496
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 51, in starmapstar
    return list(itertools.starmap(args[0], args[1]))
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 236, in _proc
    return_rollout = rollout_imitation(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 169, in rollout_imitation
    traj, info = eval_fn(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 533, in pick_place_eval
    return pick_place_eval_demo_cond(model=model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 324, in pick_place_eval_demo_cond
    action, target_pred, target_obj_emb, activation_map, prediction_internal_obj, predicted_bb = get_action(
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/utils.py", line 416, in get_action
    out = model(states=s_t,
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 677, in forward
    embed_out = self._embed(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 234, in forward
    im_features, no_pe_img_features = network_fn(im_in)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 295, in _resnet_features
    features = self._img_encoder(x)  # x is B, T, ch, h, w -> B, T, d, H, W
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/basic_embedding.py", line 48, in forward
    out = self._features(x)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 550, in <module>
    task_success_flags = p.starmap(f, seeds)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 372, in starmap
    return self._map_async(func, iterable, starmapstar, chunksize).get()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 771, in get
    raise self._value
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 🚀 View run genial-elevator-63 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/6lbdoia3
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_155823-6lbdoia3/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_160425-mwmv4a35
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sunny-violet-64
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/mwmv4a35
146740
Appending saved step 146740
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-146740.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 146740
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-146740
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00021791458129882812
Gen_anc_base 0.7795407772064209
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 51, in starmapstar
    return list(itertools.starmap(args[0], args[1]))
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 236, in _proc
    return_rollout = rollout_imitation(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 169, in rollout_imitation
    traj, info = eval_fn(model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 533, in pick_place_eval
    return pick_place_eval_demo_cond(model=model,
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/pick_place.py", line 324, in pick_place_eval_demo_cond
    action, target_pred, target_obj_emb, activation_map, prediction_internal_obj, predicted_bb = get_action(
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/utils.py", line 416, in get_action
    out = model(states=s_t,
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 677, in forward
    embed_out = self._embed(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 234, in forward
    im_features, no_pe_img_features = network_fn(im_in)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/mt_rep.py", line 295, in _resnet_features
    features = self._img_encoder(x)  # x is B, T, ch, h, w -> B, T, d, H, W
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/training/multi_task_il/models/basic_embedding.py", line 48, in forward
    out = self._features(x)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/container.py", line 204, in forward
    input = module(input)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/test/multi_task_test/test_any_task.py", line 550, in <module>
    task_success_flags = p.starmap(f, seeds)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 372, in starmap
    return self._map_async(func, iterable, starmapstar, chunksize).get()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 771, in get
    raise self._value
RuntimeError: cuDNN error: CUDNN_STATUS_NOT_INITIALIZED
wandb: Waiting for W&B process to finish... (failed 1). Press Control-C to abort syncing.
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 🚀 View run sunny-violet-64 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/mwmv4a35
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v3
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_160425-mwmv4a35/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_161022-a5f0oe8y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sandy-frog-65
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/a5f0oe8y
149930
Appending saved step 149930
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-149930.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 149930
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-149930
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014328956604003906
Gen_anc_base 0.6868598461151123
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Terminated
Process ForkServerPoolWorker-3:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Process ForkServerPoolWorker-4:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_161533-cb8935ol
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-dragon-66
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/cb8935ol
153120
Appending saved step 153120
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-153120.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 153120
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-153120
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00019621849060058594
Gen_anc_base 0.7272393703460693
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 7 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Killed
Process ForkServerPoolWorker-3:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
Killed
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Process ForkServerPoolWorker-7:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Process ForkServerPoolWorker-5:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Process ForkServerPoolWorker-6:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? 1.0 
Process ForkServerPoolWorker-2:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Process ForkServerPoolWorker-4:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Process ForkServerPoolWorker-1:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_162558-f7vmgygg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stellar-breeze-68
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/f7vmgygg
137170
Appending saved step 137170
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-137170.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 137170
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-137170
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00018978118896484375
Gen_anc_base 0.7210471630096436
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.9
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.1
Success rate on task#15 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked █████▁█▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █████▁█▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.9
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run stellar-breeze-68 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/f7vmgygg
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_162558-f7vmgygg/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_163335-csfycchm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run stoic-elevator-69
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/csfycchm
140360
Appending saved step 140360
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-140360.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 140360
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-140360
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014734268188476562
Gen_anc_base 0.6481435298919678
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.3
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁█▁▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁██▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run stoic-elevator-69 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/csfycchm
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_163335-csfycchm/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_164022-simfcq3f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wise-bee-70
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/simfcq3f
143550
Appending saved step 143550
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-143550.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 143550
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-143550
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014662742614746094
Gen_anc_base 0.6969671249389648
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.9
Success rate on task#11 0.0
Success rate on task#15 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █████████▁▁█████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.9
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run wise-bee-70 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/simfcq3f
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_164022-simfcq3f/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_164742-7kwtvc25
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run woven-bush-71
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/7kwtvc25
146740
Appending saved step 146740
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-146740.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 146740
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-146740
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014591217041015625
Gen_anc_base 0.6810011863708496
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁████████▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁▁▁▁▁▁▁▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run woven-bush-71 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/7kwtvc25
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_164742-7kwtvc25/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_165503-2a5sgslo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-wave-72
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/2a5sgslo
149930
Appending saved step 149930
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-149930.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 149930
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-149930
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001418590545654297
Gen_anc_base 0.6724119186401367
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.1
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.0
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁████▁████▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.1
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.02236
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run bright-wave-72 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/2a5sgslo
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_165503-2a5sgslo/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_170213-fm63puu8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-fire-73
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/fm63puu8
153120
Appending saved step 153120
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-153120.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 153120
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-153120
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014472007751464844
Gen_anc_base 0.6552670001983643
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.55
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.45
Success rate on task#11 0.7
Success rate on task#15 0.4
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁█▁██▁██▁███▁▁▁▁▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ███▁█▁▁█▁▁█▁▁▁█████▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.45
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.55
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.12298
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run faithful-fire-73 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/fm63puu8
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_170213-fm63puu8/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_170926-0p6po9xj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run brisk-firefly-74
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/0p6po9xj
156310
Appending saved step 156310
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-156310.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 156310
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-156310
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014472007751464844
Gen_anc_base 0.6981167793273926
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: \ 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ███████▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁██████▁▁████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁▁▁▁▁▁▁▁██▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run brisk-firefly-74 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/0p6po9xj
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_170926-0p6po9xj/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_171700-yqva8r80
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run smooth-hill-75
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/yqva8r80
159500
Appending saved step 159500
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-159500.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 159500
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-159500
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001499652862548828
Gen_anc_base 0.7376816272735596
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.1
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.1
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁██▁█▁█▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁█▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.1
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.02236
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run smooth-hill-75 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/yqva8r80
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_171700-yqva8r80/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_172427-sjygnq1w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run scarlet-yogurt-76
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/sjygnq1w
162690
Appending saved step 162690
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-162690.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 162690
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-162690
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0002155303955078125
Gen_anc_base 0.7073960304260254
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 1.0
Success rate on task#11 0.0
Success rate on task#15 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 1.0
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run scarlet-yogurt-76 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/sjygnq1w
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_172427-sjygnq1w/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_173312-lwessu1x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-glade-77
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/lwessu1x
165880
Appending saved step 165880
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-165880.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 165880
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-165880
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016760826110839844
Gen_anc_base 0.6580295562744141
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.0
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.95
Success rate on task#11 0.0
Success rate on task#15 0.0
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ████████████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.95
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.0
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run dashing-glade-77 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/lwessu1x
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_173312-lwessu1x/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_174222-4rrgbmqo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jolly-moon-78
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/4rrgbmqo
169070
Appending saved step 169070
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-169070.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 169070
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-169070
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001475811004638672
Gen_anc_base 0.7095663547515869
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.9
Success rate on task#11 0.0
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ███████▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁████████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.9
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run jolly-moon-78 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/4rrgbmqo
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_174222-4rrgbmqo/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_175133-5psaghm0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rose-capybara-79
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/5psaghm0
172260
Appending saved step 172260
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-172260.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 172260
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-172260
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014781951904296875
Gen_anc_base 0.74072265625
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.9
Success rate on task#11 0.0
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁███▁████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.9
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run rose-capybara-79 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/5psaghm0
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_175133-5psaghm0/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_180039-3le21fmk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peach-silence-80
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3le21fmk
175450
Appending saved step 175450
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-175450.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 175450
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-175450
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.000148773193359375
Gen_anc_base 0.7401607036590576
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.1
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.1
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁██████▁██████▁██▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.1
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.02236
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run peach-silence-80 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3le21fmk
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_180039-3le21fmk/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_180954-z53jl0uw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run exalted-spaceship-81
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/z53jl0uw
178640
Appending saved step 178640
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-178640.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 178640
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-178640
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014781951904296875
Gen_anc_base 0.69287109375
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.2
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁████▁██▁█▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁▁▁▁█▁▁█▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run exalted-spaceship-81 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/z53jl0uw
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_180954-z53jl0uw/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_181908-21knvi5e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run peach-music-82
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/21knvi5e
181830
Appending saved step 181830
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-181830.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 181830
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-181830
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001506805419921875
Gen_anc_base 0.6374828815460205
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.4
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁█▁██▁█▁▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁▁█▁▁█▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run peach-music-82 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/21knvi5e
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_181908-21knvi5e/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_182809-xapyevse
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ethereal-firebrand-83
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/xapyevse
185020
Appending saved step 185020
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-185020.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 185020
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-185020
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015425682067871094
Gen_anc_base 0.7232706546783447
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.1
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁██▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁█▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run ethereal-firebrand-83 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/xapyevse
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_182809-xapyevse/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_183719-epfcuu8l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-sky-84
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/epfcuu8l
188210
Appending saved step 188210
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-188210.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 188210
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-188210
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015401840209960938
Gen_anc_base 0.6923360824584961
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.2
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.2
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁██▁█▁█▁▁████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁▁▁▁▁▁█▁██▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.2
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.04472
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run twilight-sky-84 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/epfcuu8l
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_183719-epfcuu8l/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_184616-i1sh36m9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run mild-valley-85
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/i1sh36m9
191400
Appending saved step 191400
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-191400.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 191400
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-191400
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00021839141845703125
Gen_anc_base 0.6780693531036377
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.6
Success rate on task#11 0.3
Success rate on task#15 0.4
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁████▁█▁██▁█▁██▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ███▁▁▁▁█▁█▁▁▁▁█▁▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.6
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run mild-valley-85 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/i1sh36m9
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_184616-i1sh36m9/logs
Exception in thread IntMsgThr:
pybullet build time: Sep  9 2023 15:14:45
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 980, in _bootstrap_inner
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 917, in run
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 267, in check_network_status
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 299, in check_internal_messages
    self._loop_check_status(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    self._loop_check_status(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    local_handle = request()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 735, in deliver_network_status
    local_handle = request()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 743, in deliver_internal_messages
    return self._deliver_network_status(status)
    return self._deliver_internal_messages(internal_message)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 466, in _deliver_network_status
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 472, in _deliver_internal_messages
    return self._deliver_record(record)
    return self._deliver_record(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
    handle = mailbox._deliver_record(record, interface=self)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
    interface._publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self._sock_client.send_record_publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self.send_server_request(server_req)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._send_message(msg)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    self._sendall_with_error_handle(header + data)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_185451-czuunfv7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run wise-pond-86
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/czuunfv7
194590
Appending saved step 194590
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-194590.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 194590
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-194590
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014257431030273438
Gen_anc_base 0.7083835601806641
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.3
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁█▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run wise-pond-86 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/czuunfv7
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_185451-czuunfv7/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_190219-48xaqouz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run revived-forest-87
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/48xaqouz
197780
Appending saved step 197780
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-197780.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 197780
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-197780
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014901161193847656
Gen_anc_base 0.6665279865264893
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.3
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁█████▁█▁████▁█▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ██▁▁▁▁▁█▁▁▁▁▁▁█▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run revived-forest-87 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/48xaqouz
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_190219-48xaqouz/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_190937-606cpvni
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run swift-lake-88
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/606cpvni
200970
Appending saved step 200970
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-200970.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 200970
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-200970
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00013947486877441406
Gen_anc_base 0.6758882999420166
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.2
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.2
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁████████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁█▁▁█▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.2
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.04472
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run swift-lake-88 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/606cpvni
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_190937-606cpvni/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_191719-x86zkfv1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-night-89
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/x86zkfv1
204160
Appending saved step 204160
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-204160.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 204160
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-204160
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014591217041015625
Gen_anc_base 0.6912386417388916
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
No bb target for some frames
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.9
Success rate on task#11 0.0
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.9
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run hearty-night-89 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/x86zkfv1
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_191719-x86zkfv1/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_192445-a50pf2ub
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run fine-surf-90
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/a50pf2ub
207350
Appending saved step 207350
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-207350.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 207350
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-207350
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015091896057128906
Gen_anc_base 0.6919355392456055
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.1
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁██▁██▁███▁██▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁█▁▁▁▁▁▁█▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run fine-surf-90 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/a50pf2ub
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_192445-a50pf2ub/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_193152-ryykvkz4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run true-disco-91
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ryykvkz4
210540
Appending saved step 210540
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-210540.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 210540
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-210540
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.000141143798828125
Gen_anc_base 0.6581118106842041
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.4
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁██▁█▁███▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁▁▁▁█▁█▁▁▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run true-disco-91 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ryykvkz4
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_193152-ryykvkz4/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_193859-ui4hp517
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run efficient-shadow-92
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ui4hp517
213730
Appending saved step 213730
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-213730.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 213730
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-213730
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.000141143798828125
Gen_anc_base 0.6538469791412354
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.2
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.1
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁████▁▁▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁█▁▁▁▁▁██▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.2
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.04472
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run efficient-shadow-92 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ui4hp517
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_193859-ui4hp517/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_194608-9n6yi892
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run generous-plant-93
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/9n6yi892
216920
Appending saved step 216920
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-216920.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 216920
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-216920
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014448165893554688
Gen_anc_base 0.6626324653625488
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.3
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁██████▁█▁████▁█▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success █▁▁▁▁▁▁█▁█▁▁▁▁█▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run generous-plant-93 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/9n6yi892
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_194608-9n6yi892/logs
Exception in thread NetStatThr:
pybullet build time: Sep  9 2023 15:14:45
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 980, in _bootstrap_inner
Exception in thread IntMsgThr:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 917, in run
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 267, in check_network_status
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 299, in check_internal_messages
    self._loop_check_status(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    self._loop_check_status(
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 223, in _loop_check_status
    local_handle = request()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 735, in deliver_network_status
    local_handle = request()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 743, in deliver_internal_messages
    return self._deliver_network_status(status)
    return self._deliver_internal_messages(internal_message)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 466, in _deliver_network_status
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 472, in _deliver_internal_messages
    return self._deliver_record(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
    return self._deliver_record(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 425, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    interface._publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self._sock_client.send_record_publish(record)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self.send_server_request(server_req)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._send_message(msg)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    self._sendall_with_error_handle(header + data)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_195312-02xnej0e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run golden-fire-94
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/02xnej0e
220110
Appending saved step 220110
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-220110.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 220110
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-220110
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001456737518310547
Gen_anc_base 0.6672344207763672
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? False success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.5
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.45
Success rate on task#11 0.7
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ████████████▁███████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁▁▁▁█▁█▁█▁█▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁████▁▁▁█▁█▁█▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.45
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.5
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.1118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run golden-fire-94 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/02xnej0e
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_195312-02xnej0e/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_200001-wpc5mpzp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glad-brook-95
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/wpc5mpzp
223300
Appending saved step 223300
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-223300.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 223300
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-223300
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014352798461914062
Gen_anc_base 0.6563353538513184
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.6
Success rate on task#11 0.3
Success rate on task#15 0.4
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁█▁▁█▁▁██▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁█▁█▁▁██▁▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.6
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run glad-brook-95 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/wpc5mpzp
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_200001-wpc5mpzp/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_200711-3elhlbpi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run upbeat-sea-96
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3elhlbpi
226490
Appending saved step 226490
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-226490.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 226490
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-226490
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001456737518310547
Gen_anc_base 0.6799490451812744
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.0
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ████▁██▁██▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run upbeat-sea-96 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3elhlbpi
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_200711-3elhlbpi/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_201426-vndu662o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rich-hill-97
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/vndu662o
229680
Appending saved step 229680
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-229680.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 229680
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-229680
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014591217041015625
Gen_anc_base 0.6821234226226807
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.1
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁██████▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁█▁▁▁▁▁▁█▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run rich-hill-97 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/vndu662o
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_201426-vndu662o/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_202148-ws68ut39
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run magic-galaxy-98
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ws68ut39
232870
Appending saved step 232870
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-232870.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 232870
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-232870
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016260147094726562
Gen_anc_base 0.7429602146148682
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁█▁████▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success █▁█▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run magic-galaxy-98 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/ws68ut39
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_202148-ws68ut39/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_202916-j5s2hr8c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-sky-99
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/j5s2hr8c
236060
Appending saved step 236060
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-236060.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 236060
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-236060
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001575946807861328
Gen_anc_base 0.6719503402709961
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.65
Success rate on task#11 0.4
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁██▁█▁▁▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁█▁▁█▁███▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.65
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run faithful-sky-99 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/j5s2hr8c
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_202916-j5s2hr8c/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_203612-kzfuk71n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-hill-100
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/kzfuk71n
239250
Appending saved step 239250
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-239250.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 239250
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-239250
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001494884490966797
Gen_anc_base 0.6327555179595947
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.4
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.55
Success rate on task#11 0.5
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.010 MB uploaded (0.000 MB deduped)wandb: \ 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁█▁▁█▁█▁█▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁█▁█▁▁█▁█▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.55
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.4
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.08944
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run lilac-hill-100 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/kzfuk71n
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_203612-kzfuk71n/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_204310-y3n3njs5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run zany-thunder-101
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/y3n3njs5
242440
Appending saved step 242440
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-242440.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 242440
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-242440
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015211105346679688
Gen_anc_base 0.6531021595001221
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.65
Success rate on task#11 0.5
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁█▁█▁▁████▁█▁▁████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁██▁▁▁▁█▁██▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.65
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run zany-thunder-101 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/y3n3njs5
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_204310-y3n3njs5/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_205018-h04flagi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dazzling-waterfall-102
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/h04flagi
245630
Appending saved step 245630
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-245630.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 245630
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-245630
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016188621520996094
Gen_anc_base 0.7315237522125244
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁█▁████▁█▁██████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success █▁█▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run dazzling-waterfall-102 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/h04flagi
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_205018-h04flagi/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_205755-br2iyo14
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run graceful-mountain-103
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/br2iyo14
248820
Appending saved step 248820
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-248820.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 248820
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-248820
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014495849609375
Gen_anc_base 0.7090251445770264
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ████▁██▁█▁▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁█▁▁█▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run graceful-mountain-103 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/br2iyo14
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_205755-br2iyo14/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_210524-6admejj6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run robust-frog-104
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/6admejj6
252010
Appending saved step 252010
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-252010.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 252010
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-252010
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00017309188842773438
Gen_anc_base 0.6781778335571289
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.4
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.6
Success rate on task#11 0.5
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁█▁██▁█▁██▁███▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ███▁█▁▁█▁█▁▁█▁▁▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.6
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.4
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.08944
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run robust-frog-104 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/6admejj6
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_210524-6admejj6/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: / Waiting for wandb.init()...wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_211253-0n2xm0wr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lucky-pond-105
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/0n2xm0wr
255200
Appending saved step 255200
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-255200.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 255200
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-255200
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016689300537109375
Gen_anc_base 0.6755537986755371
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.3
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.3
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁██▁█▁▁██████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁█▁▁█▁██▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.3
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.06708
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run lucky-pond-105 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/0n2xm0wr
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_211253-0n2xm0wr/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_212034-sel6tz7m
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run rose-microwave-106
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/sel6tz7m
258390
Appending saved step 258390
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-258390.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 258390
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-258390
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014591217041015625
Gen_anc_base 0.6690547466278076
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.6
Success rate on task#11 0.4
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁████▁█▁▁█▁▁██▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁▁▁▁█▁▁█▁██▁▁█▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.6
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run rose-microwave-106 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/sel6tz7m
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_212034-sel6tz7m/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_212800-kduhrs8g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run proud-field-107
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/kduhrs8g
261580
Appending saved step 261580
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-261580.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 261580
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-261580
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015473365783691406
Gen_anc_base 0.6980526447296143
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.2
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁█▁██▁▁██████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁█▁▁██▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run proud-field-107 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/kduhrs8g
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_212800-kduhrs8g/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_213516-qawiryfp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run giddy-leaf-108
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/qawiryfp
264770
Appending saved step 264770
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-264770.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 264770
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-264770
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016355514526367188
Gen_anc_base 0.6813340187072754
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.05
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.95
Success rate on task#11 0.0
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁████████████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.95
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.05
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.01118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run giddy-leaf-108 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/qawiryfp
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_213516-qawiryfp/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_214321-9c75haux
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run lilac-tree-109
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/9c75haux
267960
Appending saved step 267960
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-267960.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 267960
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-267960
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00017380714416503906
Gen_anc_base 0.7666599750518799
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.1
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.9
Success rate on task#11 0.1
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ███████▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁▁▁▁█▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.9
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.1
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.02236
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run lilac-tree-109 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/9c75haux
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_214321-9c75haux/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_215058-5mse3p3q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kind-darkness-110
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/5mse3p3q
271150
Appending saved step 271150
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-271150.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 271150
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-271150
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015234947204589844
Gen_anc_base 0.7112948894500732
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.2
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁█▁██▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁█▁█▁▁▁▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run kind-darkness-110 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/5mse3p3q
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_215058-5mse3p3q/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_215833-3js65773
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bright-lake-111
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3js65773
274340
Appending saved step 274340
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-274340.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 274340
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-274340
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00018405914306640625
Gen_anc_base 0.6988232135772705
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.65
Success rate on task#11 0.4
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ████▁██▁█▁▁█▁█▁██▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁▁▁█▁▁█▁██▁█▁█▁▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.65
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run bright-lake-111 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/3js65773
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_215833-3js65773/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_220555-e6i4i66k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run solar-tree-112
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/e6i4i66k
277530
Appending saved step 277530
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-277530.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 277530
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-277530
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.000164031982421875
Gen_anc_base 0.6975119113922119
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.3
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.7
Success rate on task#11 0.4
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁█▁██▁█▁▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁▁█▁██▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.7
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.3
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.06708
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run solar-tree-112 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/e6i4i66k
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_220555-e6i4i66k/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_221325-biktyk6v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run earthy-blaze-113
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/biktyk6v
280720
Appending saved step 280720
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-280720.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 280720
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-280720
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014543533325195312
Gen_anc_base 0.6925656795501709
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.1
Success rate on task#15 0.4
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁█████▁█▁██▁▁██████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁█▁▁▁▁▁█▁█▁▁██▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run earthy-blaze-113 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/biktyk6v
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_221325-biktyk6v/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_222052-rgy6d5vp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-wood-114
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/rgy6d5vp
280720
Appending saved step 280720
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-280720.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 280720
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-280720
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016760826110839844
Gen_anc_base 0.706836462020874
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.2
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.8
Success rate on task#11 0.2
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁█▁██▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁█▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.8
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.2
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.04472
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run genial-wood-114 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/rgy6d5vp
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_222052-rgy6d5vp/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_222819-zw1k20me
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-glade-115
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/zw1k20me
283910
Appending saved step 283910
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-283910.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 283910
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-283910
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001628398895263672
Gen_anc_base 0.7118866443634033
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.4
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁█▁█▁▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁██▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run hearty-glade-115 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/zw1k20me
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_222819-zw1k20me/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_223552-35wljyf3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run whole-yogurt-116
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/35wljyf3
287100
Appending saved step 287100
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-287100.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 287100
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-287100
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.000152587890625
Gen_anc_base 0.7205381393432617
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.15
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.85
Success rate on task#11 0.2
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.017 MB uploaded (0.000 MB deduped)wandb: | 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁████▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁▁▁▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.85
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.15
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.03354
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run whole-yogurt-116 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/35wljyf3
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_223552-35wljyf3/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_232831-t5ccbpa0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run faithful-flower-117
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/t5ccbpa0
223300
Appending saved step 223300
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-223300.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1
loading model from saved training step 223300
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1/step-223300
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00017905235290527344
Gen_anc_base 0.7334740161895752
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.2
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.2
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁█▁██▁█▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁█▁▁▁▁█▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.2
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.04472
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run faithful-flower-117 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/t5ccbpa0
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_232831-t5ccbpa0/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_233612-be0waplp
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run legendary-snowflake-118
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/be0waplp
223300
Appending saved step 223300
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-223300.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 223300
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-223300
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014853477478027344
Gen_anc_base 0.6959836483001709
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.45
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.55
Success rate on task#11 0.5
Success rate on task#15 0.4
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁▁███▁██▁█▁▁▁█▁▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁██▁▁▁█▁▁█▁███▁██▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.55
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.45
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.10062
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run legendary-snowflake-118 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/be0waplp
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_233612-be0waplp/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_234353-akc613zj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run giddy-sun-119
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/akc613zj
223300
Appending saved step 223300
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-223300.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 223300
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-223300
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00017404556274414062
Gen_anc_base 0.6979916095733643
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Process ForkServerPoolWorker-3:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Process ForkServerPoolWorker-2:
Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 131, in worker
    put((job, i, result))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/pool.py", line 136, in worker
    put((job, i, (False, wrapped)))
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/queues.py", line 377, in put
    self._writer.send_bytes(obj)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
BrokenPipeError: [Errno 32] Broken pipe
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
/raid/home/frosa_Loc/conda/envs/multi_task_lfd/lib/python3.9/multiprocessing/resource_tracker.py:216: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_235104-eo46f7d7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run youthful-glitter-120
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/eo46f7d7
220110
Appending saved step 220110
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-220110.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1
loading model from saved training step 220110
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1/step-220110
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001575946807861328
Gen_anc_base 0.7484266757965088
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? False success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.65
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.3
Success rate on task#11 0.8
Success rate on task#15 0.5
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked █████████████████▁██
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁█▁██▁█▁▁█▁▁▁▁▁▁▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ███▁█▁▁█▁██▁█████▁█▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.3
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.65
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.14534
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run youthful-glitter-120 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/eo46f7d7
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_235104-eo46f7d7/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240110_235827-jp86gfmx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run tough-dust-121
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/jp86gfmx
220110
Appending saved step 220110
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-220110.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 220110
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-220110
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015282630920410156
Gen_anc_base 0.6890096664428711
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.6
Success rate on task#11 0.4
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.007 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ███████▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁█▁▁▁▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁▁▁████▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.6
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run tough-dust-121 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/jp86gfmx
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240110_235827-jp86gfmx/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_000546-pdzl4mm2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dazzling-mountain-122
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/pdzl4mm2
220110
Appending saved step 220110
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-220110.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 220110
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-220110
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.0001499652862548828
Gen_anc_base 0.7129216194152832
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.55
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.4
Success rate on task#11 0.8
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.017 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ███████▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁▁▁█▁██▁▁▁▁▁▁█▁███▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ███▁█▁▁▁█████▁█▁▁▁█▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.4
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.55
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.12298
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run dazzling-mountain-122 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/pdzl4mm2
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_000546-pdzl4mm2/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_001303-wlqpdz1k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run effortless-rain-123
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/wlqpdz1k
239250
Appending saved step 239250
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-239250.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1
loading model from saved training step 239250
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1/step-239250
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015616416931152344
Gen_anc_base 0.8063337802886963
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.5
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.45
Success rate on task#11 0.5
Success rate on task#15 0.5
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁▁▁██▁█▁▁█▁██▁▁█▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁████▁▁█▁██▁▁▁▁██▁█▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.45
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.5
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.1118
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run effortless-rain-123 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/wlqpdz1k
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_001303-wlqpdz1k/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_002046-rwbg9h1r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run super-dawn-124
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/rwbg9h1r
239250
Appending saved step 239250
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-239250.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 239250
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-239250
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014090538024902344
Gen_anc_base 0.7071232795715332
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.45
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.45
Success rate on task#11 0.6
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: / 0.019 MB of 0.019 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁█▁▁█▁▁▁▁▁███
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁▁▁▁█▁█████▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.45
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.45
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.10062
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run super-dawn-124 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/rwbg9h1r
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_002046-rwbg9h1r/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_002806-we7gnc5f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glorious-eon-125
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/we7gnc5f
239250
Appending saved step 239250
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-239250.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 239250
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-239250
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014829635620117188
Gen_anc_base 0.7938799858093262
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? False success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 402418010
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #19, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 0.95
Task success, rate 0.4
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.55
Success rate on task#11 0.5
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: \ 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: | 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: / 0.006 MB of 0.006 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ███████▁████████████
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong █▁▁█▁██▁█▁▁█▁████▁▁█
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁██▁█▁▁▁▁██▁█▁▁▁▁██▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 0.95
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.55
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.4
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.08944
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run glorious-eon-125 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/we7gnc5f
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_002806-we7gnc5f/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_003524-xcy35o60
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run twilight-mountain-126
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/xcy35o60
252010
Appending saved step 252010
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-252010.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1
loading model from saved training step 252010
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28//results_pick_place/pred_bb/run_1/step-252010
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00014352798461914062
Gen_anc_base 0.6984031200408936
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 107420369
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #2, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1051802512
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #5, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 440213415
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #9, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 373399426
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #14, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3163119785
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #8, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2342331444
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #13, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 127978094
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #18, task#11, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.25
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.75
Success rate on task#11 0.4
Success rate on task#15 0.1
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁█▁██▁██▁█▁███████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁▁█▁▁█▁█▁▁▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.75
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.25
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.0559
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run twilight-mountain-126 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/xcy35o60
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v4
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_003524-xcy35o60/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_004312-islps16p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run apricot-breeze-127
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/islps16p
252010
Appending saved step 252010
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-252010.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 252010
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-252010
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00016117095947265625
Gen_anc_base 0.6644566059112549
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3831882064
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #12, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 478163327
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #1, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 3184935163
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #3, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 958682846
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #6, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 136505587
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #17, task#15, reached? True picked? True success? 1.0 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.35
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.65
Success rate on task#11 0.4
Success rate on task#15 0.3
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ██▁████▁█▁▁█▁█▁██▁██
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁▁▁▁█▁██▁█▁█▁▁█▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.65
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.35
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.07826
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run apricot-breeze-127 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/islps16p
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_004312-islps16p/logs
pybullet build time: Sep  9 2023 15:14:45
wandb: Currently logged in as: francescorosa97. Use `wandb login --relogin` to force relogin
wandb: - Waiting for wandb.init()...wandb: \ Waiting for wandb.init()...wandb: | Waiting for wandb.init()...wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.15.10
wandb: Run data is saved locally in /raid/home/frosa_Loc/Multi-Task-LFD-Framework/repo/Multi-Task-LFD-Training-Framework/bashes/wandb/run-20240111_004955-x2nht054
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run firm-butterfly-128
wandb: ⭐️ View project at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left
wandb: 🚀 View run at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/x2nht054
252010
Appending saved step 252010
Testing model /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/model_save-252010.pt
Result dir /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/
loading model from saved training step 252010
Made new path for results at: /user/frosa/multi_task_lfd/checkpoint_save_folder/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left-Batch28/results_pick_place/step-252010
Multi-task dataset, tasks used:  [{'name': 'pick_place', 'n_tasks': 16, 'crop': [20, 25, 80, 75], 'n_per_task': 2, 'task_ids': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], 'skip_ids': [11, 15], 'loss_mul': 1, 'task_per_batch': 16, 'traj_per_subtask': 100, 'demo_per_subtask': 100}]
pretrain False
---- Backbone summary of resnet ----
A total of 2 layers, cross demo-obs attention starts at layer idx 0
Position embedding shape: torch.Size([1, 128, 5000]) 

Linear embedder has input dim: 128x13x23=38272 
Loading video backbone r2plus1d_18.....
Loading  backbone resnet18.....
pretrain False
---- Backbone summary of resnet ----
---- Summary backbone with FiLM layer ----
Gen anc centers 0.00015211105346679688
Gen_anc_base 0.6645021438598633
Total params in Detection module: 34080398
Image feature dimensions: torch.Size([1, 11, 128, 13, 23])
Contrastive MLP using hidden dim:  128
Concat-ing embedded demo to action head? True, to distribution head? False
Total params in Imitation module: 79581321

---- Complete model ----

Found 4 GPU devices, using 5 parallel workers for evaluating 20 total trajectories

Renderer is using size (200, 360) 

---- Testing model multi_task_il.models.mt_rep.VideoImitation ----
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
pybullet build time: Sep  9 2023 15:14:45
Found 8 GPUs for rendering. Using device 0.
Model GPU id 3
Seed: 1181241943
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #4, task#11, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 3181143731
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #11, task#15, reached? True picked? True success? False 
Model GPU id 3
Seed: 1812140441
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #16, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2746317213
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #0, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 599310825
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #7, task#15, reached? True picked? True success? 1.0 
Model GPU id 3
Seed: 2906402157
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object bluebox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #10, task#11, reached? True picked? True success? False 
Model GPU id 3
Seed: 2536146025
GPU-ID 0
Panda_PickPlaceDistractor
Render GPU id 0
Object set 2
Target object redbox
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
GPU-ID 0
UR5e_PickPlaceDistractor
Render GPU id 0
Object set 2
Max-t 95
Evaluated traj #15, task#15, reached? True picked? True success? False 
Task reached, rate 1.0
Task picked, rate 1.0
Task success, rate 0.3
Task reached_wrong, rate 0.0
Task picked_wrong, rate 0.0
Task place_wrong, rate 0.65
Success rate on task#11 0.4
Success rate on task#15 0.2
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:        avg_picked ▁
wandb:  avg_picked_wrong ▁
wandb:   avg_place_wrong ▁
wandb:          avg_pred ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:    avg_prediction ▁
wandb:       avg_reached ▁
wandb: avg_reached_wrong ▁
wandb:       avg_success ▁
wandb:           episode ▁▁▂▂▂▃▃▄▄▄▅▅▅▆▆▇▇▇██
wandb:            picked ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:      picked_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:       place_wrong ▁█▁█▁██▁█▁██▁█▁█████
wandb:           reached ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:     reached_wrong ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           success ▁▁█▁█▁▁█▁█▁▁█▁█▁▁▁▁▁
wandb:       success_err ▁
wandb:      variation_id ▁█▁█▁█▁█▁█▁█▁█▁█▁█▁█
wandb: 
wandb: Run summary:
wandb:        avg_picked 1.0
wandb:  avg_picked_wrong 0.0
wandb:   avg_place_wrong 0.65
wandb:          avg_pred 0.0
wandb:    avg_prediction 0.0
wandb:       avg_reached 1.0
wandb: avg_reached_wrong 0.0
wandb:       avg_success 0.3
wandb:           episode 19
wandb:            picked 1.0
wandb:      picked_wrong 0.0
wandb:       place_wrong 1.0
wandb:           reached 1.0
wandb:     reached_wrong 0.0
wandb:           success 0.0
wandb:       success_err 0.06708
wandb:      variation_id 15
wandb: 
wandb: 🚀 View run firm-butterfly-128 at: https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/runs/x2nht054
wandb: ️⚡ View job at https://wandb.ai/francescorosa97/1Task-Pick-Place-Mosaic-100-180-Target-Obj-Detector-BB-All-Obj-One-Task-Left/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjEyNjgzOTY1OA==/version_details/v5
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240111_004955-x2nht054/logs
pybullet build time: Sep  9 2023 15:14:45
